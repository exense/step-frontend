@mixin animation($type, $time) {
  -webkit-transition: $type $time ease;
  transition: $type $time ease;
}

@mixin opacity-animation($time: 0.3s) {
  @include animation(opacity, $time);
}

th[step-header-cell] {
  .cell-content {
    white-space: nowrap;

    &.pointer {
      cursor: pointer;
    }

    &.hidden {
      display: none;
    }
  }

  .step-header-cell,
  .additional-controls {
    display: flex;
    align-items: center;
  }

  .additional-controls {
    flex-grow: 1;
  }

  .cell-content + .additional-controls {
    margin-left: 1rem;
  }

  .sort {
    display: flex;
    flex-direction: column;
    cursor: pointer;
    margin-left: 0;
    padding: 0 1rem;

    @include animation('margin-left', 0.1s);

    &.no-value {
      margin-left: -2.4rem;
    }

    step-icon {
      opacity: 0;
      @include opacity-animation;

      &.visible {
        opacity: 1;
      }
    }

    step-icon:first-child {
      height: 1rem;
      min-height: 1rem;
    }
  }

  .search-container {
    position: relative;
    width: 100%;
    min-width: 2.4rem;
    min-height: 2.4rem;
    @include animation(width, 0.5s);

    .filter-icon {
      position: absolute;
      left: 0;
      right: 0;
      top: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      opacity: 0;
      z-index: -1;
      @include opacity-animation(0.5s);
    }

    .search-control {
      opacity: 1;
      @include opacity-animation(0.5s);
    }

    &.no-value {
      width: 0%;

      .filter-icon {
        opacity: 1;
      }

      .search-control {
        opacity: 0;
      }
    }
  }

  .cell-content:hover + .sort,
  .sort:hover {
    &.no-value {
      display: flex;
      margin-left: 0;
      step-icon {
        opacity: 1;
      }
    }
  }

  .step-header-cell.child-in-focus .additional-controls,
  .step-header-cell.filter-force-visible .additional-controls,
  .additional-controls:hover {
    .search-container.no-value {
      width: 100%;

      .filter-icon {
        opacity: 0;
      }

      .search-control {
        opacity: 1;
        step-form-field {
          display: initial;
        }
      }
    }
  }
}
