<!--Both variants are required, until both are used at the same time -->
<ng-template #filtersInSeparateRow>
  <ng-container
    *ngFor="let col of columns; trackBy: trackByCol"
    [matColumnDef]="col.id!"
    internal
    stepSearchCol
    [isSearchDisabled]="isSearchDisabled"
  >
    <ng-container *ngIf="col | customSearchCellComponent as customSearchCellKey">
      <step-search-custom-cell *stepSearchCellDef [itemKey]="customSearchCellKey" [context]="col">
      </step-search-custom-cell>
    </ng-container>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>
      <ng-container *ngIf="col.description">
        <step-icon [matTooltip]="col.description" name="help-circle"></step-icon>
      </ng-container>
      {{ col.label }}
    </th>
    <td mat-cell *matCellDef="let element">
      <ng-template #cellValue>
        {{ element | customCellValue: col.id! }}
      </ng-template>
      <div class="custom-cell-container" *ngIf="col | customCellComponents as customCellKeys; else cellValue">
        <step-custom-cell *ngFor="let cellKey of customCellKeys" [itemKey]="cellKey" [context]="element">
        </step-custom-cell>
      </div>
    </td>
  </ng-container>
</ng-template>
<ng-template #filtersInHeaderRow>
  <ng-container *ngFor="let col of columns; trackBy: trackByCol" [matColumnDef]="col.id!" internal>
    <th
      mat-header-cell
      *matHeaderCellDef
      step-header-cell
      stepSortHeader
      stepSearchHeader
      [isSearchDisabled]="isSearchDisabled"
    >
      <ng-container *ngIf="col | customSearchCellComponent as customSearchCellKey">
        <step-search-custom-cell *stepSearchCellDef [itemKey]="customSearchCellKey" [context]="col">
        </step-search-custom-cell>
      </ng-container>
      <ng-container *ngIf="col.description">
        <step-icon [matTooltip]="col.description" name="help-circle"></step-icon>
      </ng-container>
      {{ col.label }}
    </th>
    <td mat-cell *matCellDef="let element">
      <ng-template #cellValue>
        {{ element | customCellValue: col.id! }}
      </ng-template>
      <div class="custom-cell-container" *ngIf="col | customCellComponents as customCellKeys; else cellValue">
        <step-custom-cell *ngFor="let cellKey of customCellKeys" [itemKey]="cellKey" [context]="element">
        </step-custom-cell>
      </div>
    </td>
  </ng-container>
</ng-template>
<ng-container *ngIf="isFiltersInSeparateRow; then filtersInSeparateRow; else filtersInHeaderRow"> </ng-container>
