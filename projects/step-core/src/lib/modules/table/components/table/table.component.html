@if ((tableDataSource?.inProgress$ | async) || inProgress()) {
  <div class="spinner-container">
    <mat-spinner />
  </div>
}
@for (additionalHeaderGroup of additionalHeaderGroups; track additionalHeaderGroup) {
  <div class="additional-header" [class.additional-header-flex]="!!additionalHeaderGroup[1]">
    @for (additionalHeader of additionalHeaderGroup; track additionalHeader.headerGroupId) {
      <ng-container *ngTemplateOutlet="additionalHeader!.template" />
    }
  </div>
}
@if (_tableColumns.remoteColumnsScreenId; as screen) {
  <step-custom-columns
    [screen]="screen"
    [entitySubPath]="_tableColumns.entityScreenSubPath"
    [options]="_tableColumns.customColumnOptions"
  />
}
<div class="table-container">
  <table mat-table [dataSource]="tableDataSource!" [trackBy]="trackBy">
    @for (searchCol of searchColumns; track searchCol.colName) {
      <ng-container [matColumnDef]="searchCol.colName">
        <th mat-header-cell *matHeaderCellDef>
          @if (searchCol.searchName) {
            @if (searchCol.template) {
              <ng-container *ngTemplateOutlet="searchCol.template" />
            } @else {
              <ng-container [stepSearchColMeta]="searchCol">
                <step-input-filter stepFilterConnect />
              </ng-container>
            }
          }
        </th>
      </ng-container>
    }
    <tr mat-header-row *matHeaderRowDef="displayColumns()"></tr>
    @if (displaySearchColumns().length > 0) {
      <tr mat-header-row *matHeaderRowDef="displaySearchColumns()"></tr>
    }
    <tr
      mat-row
      *matRowDef="let row; columns: displayColumns()"
      class="content-row"
      [class.row-highlight]="row === highlightedItem"
    ></tr>
    <tr class="mat-mdc-row" *matNoDataRow>
      <td class="mat-mdc-cell no-data" [colSpan]="displayColumns().length">
        @if ((tableDataSource?.total$ | async) === 0) {
          No data available in table
        } @else {
          No matching records found
        }
      </td>
    </tr>
  </table>
</div>
<step-paginator
  [disabled]="pageSizeInputDisabled()"
  [length]="tableDataSource?.totalFiltered$ | async"
  [pageSizeOptions]="pageSizeOptions"
/>

@if ((tableDataSource?.total$ | async) === 0) {
  <section class="quick-actions">
    <div class="wizard-panel">
      <div>
        <div class="icon-container">
          <step-icon name="package" />
        </div>
      </div>
      <div class="wizard-content">
        <h3>1. Keywords: The building blocks</h3>
        <p>
          Keywords are the core elements of Steps automation. Each represents a specific function, ranging from a single user action or service call to a complete automated workflow.
        </p>
      </div>
      <div class="wizard-buttons">
        <button type="button" mat-flat-button (click)="openUrl('https://step.dev/knowledgebase/userdocs/keywords/')">
         Documentation
        </button>
        <button
          type="button"
          mat-flat-button
          color="primary"
          [disabled]="!('kw-write' | hasRight | async)"
          (click)="createKeyword()"
        >
          <div class="button-content">
            <span>Create Keyword</span>
            <step-icon name="plus"></step-icon>
          </div>
        </button>
      </div>
    </div>
    <div class="wizard-panel even">
      <div>
        <div class="icon-container">
          <step-icon name="packages" />
        </div>
      </div>
      <div class="wizard-content">
        <h3>2. Plan: Automated Scenario</h3>
        <p>
          A Plan is an automated scenario made up of one or more Keywords. It can define a functional test case, load test, RPA routine, or synthetic monitoring probe.
        </p>
      </div>
      <div class="wizard-buttons">
        <button type="button" mat-flat-button (click)="openUrl('https://step.dev/knowledgebase/userdocs/plans/')">
         Documentation
        </button>
        <button
          type="button"
          mat-flat-button
          color="primary"
          [disabled]="!('kw-write' | hasRight | async)"
          (click)="createPlan()"
        >
          <div class="button-content">
            <span>Create Plan</span>
            <step-icon name="plus"></step-icon>
          </div>
        </button>
      </div>
    </div>
    <div class="wizard-panel">
      <div>
        <div class="icon-container">
          <step-icon name="monitor" />
        </div>
      </div>
      <div class="wizard-content">
        <h3>3. Execute Plan</h3>
        <p>
          After creating and combining Keywords in a Plan, you can execute it. Next steps include setting up scheduled executions and monitoring as required.
        </p>
      </div>
      <div class="wizard-buttons">
        <button
          type="button"
          mat-flat-button
          (click)="openUrl('https://step.dev/knowledgebase/userdocs/executions/')"
        >
         Documentation
        </button>
      </div>
    </div>
  </section>
}
