<step-modal-window [title]="modalTitle">
  <div step-modal-window-body [formGroup]="form">
    <step-form-field>
      <step-label>ID</step-label>
      <input type="text" formControlName="id" />
      <step-suffix class="icon-suffix">
        <step-icon
          name="help-circle"
          matTooltip="Keys containing 'pwd' or 'password' will be automatically protected"
        />
      </step-suffix>
    </step-form-field>
    <step-form-field>
      <step-label>Label</step-label>
      <input type="text" formControlName="label" />
    </step-form-field>
    <step-form-field>
      <step-label>Description</step-label>
      <input type="text" formControlName="description" />
    </step-form-field>
    <step-form-field>
      <step-label>Type</step-label>
      <mat-select formControlName="type">
        @for (opt of ALLOWED_TYPES; track opt) {
          <mat-option [value]="opt">{{ opt }}</mat-option>
        }
      </mat-select>
    </step-form-field>
    @if (form.controls.type.value === 'DROPDOWN') {
      <step-custom-column-editor-dropdown-options [options]="form.controls.options" />
    }
    <step-form-field>
      <step-label>Default value</step-label>
      <input type="text" formControlName="defaultValue" />
      <step-suffix class="icon-suffix">
        <step-icon name="help-circle" matTooltip="Defines the default value of this input field (Optional)" />
      </step-suffix>
    </step-form-field>
    <step-form-field>
      <step-label>Activation expression</step-label>
      <input type="text" [stepModelFormatter]="activationExpressionFormatter" formControlName="activationExpression" />
    </step-form-field>
    <mat-expansion-panel [(expanded)]="showAdvanced">
      <mat-expansion-panel-header>
        <mat-panel-title>Advanced</mat-panel-title>
      </mat-expansion-panel-header>
      <section class="advanced-body">
        <step-form-field>
          <step-label>Value Cell Renders</step-label>
          <input type="text" [stepModelFormatter]="customUIComponentsFormatter" formControlName="customUIComponents" />
          <step-suffix class="icon-suffix">
            <step-icon
              name="help-circle"
              matTooltip="The keys of registered components, that can be used for rendering"
            />
          </step-suffix>
        </step-form-field>
        <step-form-field>
          <step-label>Search service mapper</step-label>
          <input type="text" formControlName="searchMapperService" />
          <step-suffix class="icon-suffix">
            <step-icon
              name="help-circle"
              matTooltip="When the input is used in a table, this service will be used to resolve the column filter to actual input values. The filter is passed in the body, a list of string is expected as a result (Optional)"
            />
          </step-suffix>
        </step-form-field>
      </section>
    </mat-expansion-panel>
  </div>
  <div step-modal-window-buttons>
    <button type="button" mat-stroked-button mat-dialog-close>Cancel</button>
    @if (!isNew) {
      <button type="button" mat-flat-button color="warn" (click)="remove()">Delete Column</button>
    }
    <button type="button" mat-flat-button color="primary" (click)="save()">Save Column</button>
  </div>
</step-modal-window>
