<step-expression-input
  *ngIf="dynamic; else constantValueTemplate"
  [label]="label"
  [tooltip]="tooltip"
  [isParentInvalid]="!!_ngControl.invalid"
  [showRequiredMarker]="showRequiredMarker"
  [ngModel]="expression"
  [disabled]="isDisabled"
  (ngModelChange)="onExpressionChange($event)"
  (toggleConstantValue)="toggleDynamicExpression(false)"
></step-expression-input>

<ng-template #constantValueTemplate>
  <div class="step-checkbox-container" [class.ng-invalid]="!!_ngControl.invalid">
    <section>
      <mat-checkbox
        color="primary"
        [ngModel]="value"
        (ngModelChange)="onValueChange($event)"
        [disabled]="isDisabled"
        (blur)="onBlur()"
      >
      </mat-checkbox>
      <step-label [attr.show-required-marker]="showRequiredMarker || null" *ngIf="label">{{ label }}</step-label>
      <ng-container *ngIf="tooltip">
        <step-icon name="help-circle" [matTooltip]="tooltip" matTooltipPosition="below"></step-icon>
      </ng-container>
    </section>
    <button
      type="button"
      mat-icon-button
      matTooltip="Use a dynamic expression to set this attribute"
      matTooltipPosition="below"
      class="dynamic-toggle"
      [disabled]="isDisabled"
      (click)="toggleDynamicExpression(true)"
    >
      <step-icon name="zap"></step-icon>
    </button>
  </div>
</ng-template>
