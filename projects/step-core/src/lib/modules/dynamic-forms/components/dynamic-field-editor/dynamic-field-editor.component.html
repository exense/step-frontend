<step-dynamic-field-group
  [primaryFieldsLabel]="primaryFieldsLabel ?? 'Inputs (required)'"
  [optionalFieldsLabel]="optionalFieldsLabel ?? 'Inputs (optional)'"
  [addFieldBtnLabel]="addFieldBtnLabel ?? 'Add input'"
  [schema]="schema()"
  [value]="internalValue"
  (valueChange)="handleChange($event)"
  [isDisabled]="isDisabled"
  [complexObjectTemplate]="complexFieldTemplate"
/>
<ng-template #complexFieldTemplate let-field>
  <step-dynamic-field-group
    primaryFieldsLabel="Inputs (required)"
    optionalFieldsLabel="Inputs (optional)"
    addFieldBtnLabel="Add input"
    [schema]="field.fieldSchema"
    [value]="field.value"
    (valueChange)="field.valueChange($event)"
    [isDisabled]="field.isDisabled"
    [tabIndex]="field.tabIndex"
    (blur)="field.handleBlur()"
    [complexObjectTemplate]="field.fieldObjectTemplate"
  />
</ng-template>
<div class="toggle-bar" (click)="showJson = !showJson">
  <div>
    <step-icon name="code" />
    <span>{{ jsonFieldsLabel ?? 'Input (raw JSON)' }}</span>
  </div>
  <step-icon [name]="showJson ? 'chevron-up' : 'chevron-down'" />
</div>
@if (showJson) {
  <step-json-raw-editor
    [ngModel]="internalValue"
    (ngModelChange)="handleChange($event)"
    (blur)="blur.emit()"
    [disabled]="!!isDisabled"
  />
}
