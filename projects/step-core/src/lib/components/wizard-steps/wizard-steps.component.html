<ng-container *ngIf="wizardForm" [formGroup]="wizardForm">
  <mat-stepper orientation="vertical">
    <ng-container *ngFor="let stepMeta of stepMetas; let i = index; trackBy: trackByWizardStepMeta">
      <ng-container *ngIf="wizardForm.controls[stepMeta.type] as subForm">
        <mat-step
          [label]="stepMeta.label"
          [hasError]="subForm.invalid && subForm.touched"
          errorMessage="Some fields are invalid"
        >
          <step-custom-item-render [component]="stepMeta.component" [context]="subForm"> </step-custom-item-render>
          <div class="buttons">
            <button *ngIf="i > 0" type="button" mat-button mat-raised-button matStepperPrevious>Previous</button>
            <button *ngIf="i < stepMetas.length - 1" type="button" mat-button mat-raised-button matStepperNext>
              Next
            </button>
            <button
              *ngIf="i === stepMetas.length - 1"
              type="button"
              mat-button
              mat-flat-button
              color="primary"
              (click)="finishWizard()"
            >
              Finish
            </button>
          </div>
        </mat-step>
      </ng-container>
    </ng-container>
    <ng-template matStepperIcon="edit">
      <step-icon class="step-edit-icon" name="edit-2"></step-icon>
    </ng-template>
    <ng-template matStepperIcon="error">
      <step-icon class="step-error-icon" name="alert-circle"></step-icon>
    </ng-template>
  </mat-stepper>
</ng-container>
