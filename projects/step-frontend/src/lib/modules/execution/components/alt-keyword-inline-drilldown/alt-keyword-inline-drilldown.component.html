@if (node(); as node) {
  @switch (artefactClass()) {
    @case ('CallKeyword') {
      <section class="col-view">
        @if (!(node.input | isEmptyJson)) {
          <div>
            <label>Input</label>
            <step-json-viewer [json]="node.input" [format]="ViewerFormat.KV" />
          </div>
        }
        @if (!(node.output | isEmptyJson)) {
          <div>
            <label>Output</label>
            <step-json-viewer [json]="node.output" [format]="ViewerFormat.KV" />
          </div>
        }
      </section>
    }
    @case ('Echo') {
      @if (node.echo) {
        <section>
          <label>Echo</label>
          <div>{{ node.echo }}</div>
        </section>
      }
    }
    @case ('Assert') {
      @if (!node.error && node.message; as msg) {
        <section>{{ msg }}</section>
      }
    }
    @case ('Set') {
      <section>{{ node.key }} = {{ node.value }}</section>
    }
  }
  <!--Assertion errors-->
  @if (children()?.length) {
    <section>
      <label>Errors</label>
      <div>
        @for (child of children(); track child.id) {
          <step-assert-report-node-short [node]="child" />
        }
      </div>
    </section>
  }
  <!--Error-->
  @if (node.error; as err) {
    <section>
      <label>Error</label>
      <div>
        {{ err.msg }}
        {{ !!node.attachments?.length ? '. Check the attachments for more details.' : '' }}
      </div>
    </section>
  }
  <!--Attachments-->
  @if (!!node.attachments?.length) {
    <section>
      <step-attachments-preview [attachments]="node.attachments" />
    </section>
  }
  <!--Details-->
  <section>
    <step-report-node [reportNodeId]="node.id" [showArtefact]="false" />
  </section>
  <hr />
  <section class="footer">
    <span class="muted mat-small">Start: {{ node?.executionTime | date: 'dd.MM.yyyy HH:mm:ss:SSS' }}</span>
    <span class="muted mat-small"> | Duration (ms): {{ node?.duration }}</span>
    @if (artefactClass() === 'CallKeyword') {
      <span class="muted mat-small"> | Agent: {{ node?.agentUrl }}</span>
    }
  </section>
}
