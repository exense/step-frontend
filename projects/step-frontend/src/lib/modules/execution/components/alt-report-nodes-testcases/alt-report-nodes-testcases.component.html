<step-alt-report-node-list title="Test Cases" [mode]="_mode">
  <step-table #table [dataSource]="(dataSource$ | async)!" class="paddingless-full no-border hide-header">
    <ng-container matColumnDef="duration">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        @if (element?.singleInstanceReportNode; as singleNode) {
          <step-alt-execution-time [startTime]="0" [duration]="singleNode.duration" />
        } @else if (!!element.averageDuration) {
          <step-alt-execution-time [startTime]="0" [duration]="element.averageDuration" [isAverageDuration]="true" />
        }
      </td>
    </ng-container>
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef></th>
      <td class="name" mat-cell *matCellDef="let element">
        <section (click)="showIterations(element)">
          <div class="details-trigger">
            <div>
              <step-report-node-icon [node]="element" [highlightStatus]="false" [roundBox]="true" />
              <span>
                {{ element?.singleInstanceReportNode?.name ?? element?.artefact?.attributes?.['name'] ?? '' }}
              </span>
            </div>
          </div>
          <step-aggregated-status
            [countByStatus]="element.countByStatus"
            (statusClick)="showIterations(element, $event.status, $event.count, $event.event)"
          />
        </section>
      </td>
    </ng-container>
    <ng-container matColumnDef="operations">
      <th mat-header-cell *matHeaderCellDef></th>
      <td class="operations" mat-cell *matCellDef="let element">
        @if (element?.singleInstanceReportNode; as node) {
          @if (node.status === 'RUNNING') {
            <step-alt-current-operations [reportNodeId]="node.id" [(showAll)]="showAllOperations" />
          }
        }
      </td>
    </ng-container>
    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        @if (element?.singleInstanceReportNode; as node) {
          <step-btn-group class="actions">
            <button
              type="button"
              mat-icon-button
              matTooltip="Reveal this test case in execution tree"
              matTooltipPosition="below"
              (click)="openTestCaseInTreeView.emit(node)"
            >
              <step-icon name="git-pull-request" />
            </button>
          </step-btn-group>
        }
      </td>
    </ng-container>
  </step-table>
</step-alt-report-node-list>
