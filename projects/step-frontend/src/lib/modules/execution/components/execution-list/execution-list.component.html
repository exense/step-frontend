<section class="header">
  <step-btn-group>
    <step-autorefresh-toggle [interval]="5000" (refresh)="dataSource.reload({ hideProgress: true })">
    </step-autorefresh-toggle>
  </step-btn-group>
</section>
<step-table
  [dataSource]="dataSource"
  matSort
  matSortActive="startTime"
  matSortDirection="desc"
  [matSortDisableClear]="true"
>
  <step-entity-column-container entityName="executions"> </step-entity-column-container>
  <ng-container matColumnDef="description">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSearchHeader>Description</th>
    <td mat-cell *matCellDef="let element" class="description-cell">
      <step-report-node-icon [node]="element.rootReportNode"></step-report-node-icon>
      <a href="#/root/executions/{{ element.id }}">{{ element?.description }}</a>
    </td>
  </ng-container>
  <ng-container matColumnDef="startTime">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSortHeader stepSearchHeader>
      <step-date-filter
        *stepSearchCellDef
        stepFilterConnect
        [createConditionFn]="_filterConditionFactory.singleDateFilterCondition"
      >
      </step-date-filter>
      Start time
    </th>
    <td mat-cell *matCellDef="let element">{{ element?.startTime | date: DateFormat.date }}</td>
  </ng-container>
  <ng-container matColumnDef="endTime">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSortHeader stepSearchHeader>
      <step-date-filter
        *stepSearchCellDef
        stepFilterConnect
        [createConditionFn]="_filterConditionFactory.singleDateFilterCondition"
      >
      </step-date-filter>
      End time
    </th>
    <td mat-cell *matCellDef="let element">{{ element?.endTime | date: DateFormat.date }}</td>
  </ng-container>
  <ng-container matColumnDef="user">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSortHeader stepSearchHeader>User</th>
    <td mat-cell *matCellDef="let element">{{ element?.executionParameters?.userID }}</td>
  </ng-container>
  <step-custom-columns screen="executionTable" [isFiltersInSeparateRow]="false"> </step-custom-columns>
  <ng-container matColumnDef="status">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSortHeader stepSearchHeader>
      <step-array-filter *stepSearchCellDef stepFilterConnect [useRegex]="true" [items]="(statusItems$ | async)!">
      </step-array-filter>
      Status
    </th>
    <td mat-cell *matCellDef="let element">
      <step-status [status]="element?.status"></step-status>
    </td>
  </ng-container>
  <ng-container matColumnDef="result">
    <th mat-header-cell *matHeaderCellDef step-header-cell stepSortHeader stepSearchHeader>
      <step-array-filter *stepSearchCellDef stepFilterConnect [useRegex]="true" [items]="(resultItems$ | async)!">
      </step-array-filter>
      Result
    </th>
    <td mat-cell *matCellDef="let element">
      <div class="result">
        <step-report-node-status [status]="element.result"></step-report-node-status>
      </div>
    </td>
  </ng-container>

  <ng-container matColumnDef="executionSummary">
    <th mat-header-cell *matHeaderCellDef>Summary</th>
    <td mat-cell *matCellDef="let element">
      <div class="result">
        <step-status-distribution [summary]="element.executionSummary"> </step-status-distribution>
      </div>
    </td>
  </ng-container>
</step-table>
