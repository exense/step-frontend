<section class="executions-header">
  <step-btn-group>
    <step-autorefresh-toggle [interval]="5000" (refresh)="dataSource.reload()"> </step-autorefresh-toggle>
  </step-btn-group>
</section>
<step-table
  [dataSource]="dataSource"
  matSort
  matSortActive="description"
  matSortDirection="asc"
  [matSortDisableClear]="true"
>
  <ng-container matColumnDef="description" stepSearchCol>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Description</th>
    <td mat-cell *matCellDef="let element">
      <a href="#/root/executions/{{ element.id }}">{{ element?.description }}</a>
    </td>
  </ng-container>
  <ng-container matColumnDef="startTime" stepSearchCol #searchStartTime="SearchCol">
    <step-date-filter *stepSearchCellDef (dateChanged)="searchStartTime.search($event)"> </step-date-filter>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Start time</th>
    <td mat-cell *matCellDef="let element">{{ element?.startTime | date: DateFormat.date }}</td>
  </ng-container>
  <ng-container matColumnDef="endTime" stepSearchCol #searchEndTime="SearchCol">
    <step-date-filter *stepSearchCellDef (dateChanged)="searchEndTime.search($event)"> </step-date-filter>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>End time</th>
    <td mat-cell *matCellDef="let element">{{ element?.endTime | date: DateFormat.date }}</td>
  </ng-container>
  <ng-container matColumnDef="user" stepSearchCol>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>User</th>
    <td mat-cell *matCellDef="let element">{{ element?.executionParameters?.userID }}</td>
  </ng-container>
  <ng-container matColumnDef="environment" stepSearchCol>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Environment</th>
    <td mat-cell *matCellDef="let element">{{ element?.executionParameters?.customParameters.env }}</td>
  </ng-container>
  <ng-container matColumnDef="status" stepSearchCol #searchStatus="SearchCol">
    <step-array-filter
      *stepSearchCellDef
      [items]="(statusItems$ | async)!"
      (selectedItemsChange)="searchStatus.search($event, true)"
    >
    </step-array-filter>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
    <td mat-cell *matCellDef="let element">
      <step-status [status]="element?.status"></step-status>
    </td>
  </ng-container>
  <ng-container matColumnDef="result" stepSearchCol #searchResult="SearchCol">
    <step-array-filter
      *stepSearchCellDef
      [items]="(resultItems$ | async)!"
      (selectedItemsChange)="searchResult.search($event, true)"
    >
    </step-array-filter>
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Result</th>
    <td mat-cell *matCellDef="let element">
      <div class="result">
        <step-execution-result [execution]="element"> </step-execution-result>
        <step-status-distribution [summary]="element.executionSummary"> </step-status-distribution>
      </div>
    </td>
  </ng-container>
</step-table>
