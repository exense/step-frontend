<mat-accordion multi>
  <step-panel [panelType]="Panels.testCases">
    <ng-container titleAddon>
      <step-status-distribution
        *ngIf="execution!.status != 'ENDED' && testCasesProgress!.countForecast > 0"
        class="progress-distribution"
        [summary]="testCasesProgress"
        [isProgress]="true"
      >
      </step-status-distribution>
      <step-status-distribution [summary]="testCasesProgress"> </step-status-distribution>
    </ng-container>
    <step-btn-group>
      <button type="button" mat-flat-button (click)="unselectAllTestCases()">Unselect all</button>
      <button type="button" mat-flat-button (click)="selectAllTestCases()">Select all</button>
    </step-btn-group>
    <step-table matSort #testCaseSort="matSort" (matSortChange)="handleTestCaseSort($event)" [dataSource]="testCases">
      <ng-container matColumnDef="name" stepSearchCol>
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let element">
          <a href="#" matTooltip="Drilldown" (click)="chooseTestcase(element); (false)">
            {{ element.name }}
          </a>
        </td>
      </ng-container>
      <ng-container matColumnDef="currentOperations" stepSearchCol>
        <th mat-header-cell *matHeaderCellDef>Current operations</th>
        <td mat-cell *matCellDef="let element">
          <step-current-operations
            *ngIf="element.status === 'RUNNING' && showTestCaseCurrentOperation"
            [reportNodeId]="element.id"
            [executionViewServices]="executionViewServices"
            [(showAll)]="showAllOperations"
          >
          </step-current-operations>
        </td>
      </ng-container>
      <ng-container matColumnDef="status" stepSearchCol>
        <th mat-header-cell *matHeaderCellDef>Status</th>
        <td class="status" mat-cell *matCellDef="let element">
          <step-status [status]="element.status"></step-status>
        </td>
      </ng-container>
      <ng-container matColumnDef="selection">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <step-entity-selection [entity]="element" [selectionCollector]="testCasesSelection"> </step-entity-selection>
        </td>
      </ng-container>
    </step-table>
  </step-panel>
  <step-panel [panelType]="Panels.steps">
    <ng-container titleAddon>
      <step-status-distribution
        *ngIf="execution!.status != 'ENDED' && progress && progress!.countForecast > 0"
        class="progress-distribution"
        [summary]="progress"
        [isProgress]="true"
      >
      </step-status-distribution>
      <step-status-distribution [summary]="progress"> </step-status-distribution>
    </ng-container>
    <step-keyword-calls
      [execution]="execution"
      [keywordParameters$]="keywordParameters$"
      [keywordSearch]="keywordSearch"
      (showNodeInTree)="handleShowNodeInTree($event)"
      (showTestCase)="handleShowTestCase($event)"
    >
    </step-keyword-calls>
  </step-panel>
  <step-panel [panelType]="Panels.parameters">
    <step-table [dataSource]="parameters">
      <ng-container matColumnDef="key" stepSearchCol>
        <th mat-header-cell *matHeaderCellDef>Key</th>
        <td mat-cell *matCellDef="let element">{{ element.key }}</td>
      </ng-container>
      <ng-container matColumnDef="value" stepSearchCol>
        <th mat-header-cell *matHeaderCellDef>Value</th>
        <td mat-cell *matCellDef="let element">{{ element.value }}</td>
      </ng-container>
    </step-table>
  </step-panel>
</mat-accordion>
