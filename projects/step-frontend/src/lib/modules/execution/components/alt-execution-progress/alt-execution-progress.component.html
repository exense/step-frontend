<section class="header">
  <div class="title">
    @if (execution$ | async; as execution) {
      <h3>{{ execution?.description }}</h3>
      <div class="sub-title">
        <step-alt-execution-time [execution]="execution" />
        <div class="user">{{ execution.executionParameters?.userID }}</div>
        <step-popover class="details-hint" yPosition="below">
          <step-icon name="help-circle" />
          <step-popover-content>
            <step-execution-details [execution]="execution" [showStatus]="true" />
          </step-popover-content>
        </step-popover>
      </div>
    }
  </div>
  <div class="controls">
    @if (execution$ | async; as execution) {
      <step-execution-commands
        [displayParametersForm]="false"
        [description]="execution.description"
        [repositoryObjectRef]="execution.executionParameters!.repositoryObject!"
        [execution]="execution"
        (refresh)="manualRefresh()"
        (scheduleTask)="handleTaskSchedule($event)"
      />
    }
    <step-btn-group class="without-borders">
      @if (!(isExecutionCompleted$ | async)) {
        @if (activeExecution$ | async; as activeExecution) {
          <step-autorefresh-toggle [model]="activeExecution.autoRefreshModel" buttonType="stroke" />
        }
      }
      <router-outlet name="controls" />
    </step-btn-group>
  </div>
  <div class="range-picker">
    <step-form-field>
      <step-prefix class="icon-prefix">
        <step-icon name="calendar" (click)="picker.open()" />
      </step-prefix>
      <input
        type="text"
        placeholder="From - To"
        [formControl]="dateRangeCtrl"
        [stepDateRangePicker]="picker"
        [showRelativeTime]="true"
        (relativeOptionChange)="relativeTime = $event"
      />
    </step-form-field>
    <step-date-picker #picker />
  </div>
</section>
<section class="main">
  <step-alt-execution-tabs />
  @if (execution$ | async; as execution) {
    <step-alt-report-widget class="print-execution-details">
      <step-alt-report-widget-content>
        <step-execution-details [execution]="execution" [showStatus]="true" />
      </step-alt-report-widget-content>
    </step-alt-report-widget>
  }
  <router-outlet />
</section>
<router-outlet name="modal" />
