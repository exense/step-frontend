<ng-container *ngIf="performanceViewSettings">
  <step-timeseries-toolbar
    *ngIf="context"
    [context]="context"
    [timeRangeOptions]="settings.timeRangeOptions"
    [activeTimeRange]="settings.activeTimeRange"
    (onTimeRangeChange)="handleTimeRangeChange($event)"
    (onCompareModeEnabled)="enableCompareMode()"
    (onCompareModeDisabled)="disableCompareMode()"
  ></step-timeseries-toolbar>
  <div>
    <div class="filter-bars-container" [style.gap]="compareModeEnabled ? '12px' : '0'">
      <div class="bar mat-card">
        <step-ts-filter-bar
          *ngIf="context"
          [context]="context"
          class="mat-card"
          [defaultFilterOptions]="settings.filterOptions"
          [initialFilters]="contextualFilterItems"
        >
        </step-ts-filter-bar>
        <div *ngIf="compareModeEnabled" class="stamp">BASE</div>
      </div>
      <div class="bar mat-card" [style.flexGrow]="compareModeEnabled ? 1 : 0">
        <step-ts-filter-bar
          #compareFilterBar
          *ngIf="compareModeContext"
          [context]="compareModeContext"
          class="mat-card"
          [defaultFilterOptions]="settings.filterOptions"
          [initialFilters]="compareModeContext.getFilteringSettings().filterItems"
        >
        </step-ts-filter-bar>
        <div *ngIf="compareModeEnabled" class="stamp compare">COMPARE</div>
      </div>
    </div>
  </div>

  <step-charts-view
    [context]="context"
    [settings]="performanceViewSettings"
    [timeSelection]="filterBar?.timeSelection"
  ></step-charts-view>
</ng-container>
