<div class="relative" #container>
  <div class="header-container">
    <div class="header-buttons">
      <step-autorefresh-toggle
        [interval]="refreshEnabled ? selectedRefreshInterval.value : 0"
        [presets]="refreshIntervals"
        (refresh)="triggerRefresh()"
      ></step-autorefresh-toggle>
      <button mat-icon-button [matMenuTriggerFor]="menu" class="grey-border">
        <step-icon name="settings"></step-icon>
      </button>
      <mat-menu #menu="matMenu">
        <step-ts-resolution-picker (resolutionChange)="handleResolutionChange($event)"></step-ts-resolution-picker>
        <button mat-menu-item (click)="toggleCompareMode()">
          <step-icon name="bar-chart-2" [class.active]="compareModeEnabled"></step-icon>
          {{ compareModeEnabled ? 'Disable Compare Mode' : 'Enable Compare Mode' }}
        </button>
        <button mat-menu-item (click)="exportRawData()">
          <step-icon name="download"></step-icon>
          <span>Export Raw Measurements</span>
        </button>
      </mat-menu>
      <!--      <div class="time-container">-->
      <!--        <step-time-range-picker-->
      <!--          (selectionChange)="handleTimeRangeChange($event)"-->
      <!--          [selectOptions]="dashboardSettings!.timeRangeOptions"-->
      <!--          [activeSelection]="activeSelection"-->
      <!--          [compact]="compactView"-->
      <!--        />-->
      <!--      </div>-->
    </div>
  </div>
  <step-alert type="warning" class="warning" *ngIf="compareModeEnabled && selectedRefreshInterval.value">
    Refresh will not be triggered when compare mode is enabled.
  </step-alert>

  <step-timeseries-dashboard
    #dashboard
    *ngIf="dashboardSettings"
    [settings]="dashboardSettings"
    [timeRange]="timeRange"
    (compareModeChange)="compactChange($event)"
    (contextInitialized)="dashboardContextInitialized($event)"
    (timeRangeChange)="handleDashboardTimeRangeChange($event)"
  ></step-timeseries-dashboard>
</div>
