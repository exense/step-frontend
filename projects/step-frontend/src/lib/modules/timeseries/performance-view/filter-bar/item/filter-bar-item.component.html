<div class="item-container" [matMenuTriggerFor]="menu" #matTrigger="matMenuTrigger">
  <div class="filter-label">{{ item.label || 'Not Specified' }}</div>
  <div class="filter-value">{{ formattedValue || '-' }}</div>

  <div (click)="onRemoveItem.emit()" class="remove-btn">
    <step-icon class="remove-btn" name="x"></step-icon>
  </div>
</div>

<mat-menu #menu="matMenu" [ngSwitch]="item.type">
  <div class="menu-container" (click)="$event.stopPropagation()">
    <div *ngSwitchCase="FilterBarType.OPTIONS">
      <label>{{ item.label }}</label>

      <div class="checkboxes">
        <mat-checkbox
          *ngFor="let option of item.textValues"
          color="primary"
          [checked]="option.isSelected"
          (change)="handleTextOptionClick(option, $event.checked)"
        >
          {{ option.value }}
        </mat-checkbox>
      </div>
    </div>

    <div *ngSwitchCase="FilterBarType.FREE_TEXT">
      <mat-form-field *ngIf="!item.isLocked" class="w-100">
        <mat-label>Attribute name</mat-label>
        <input type="text" matInput [(ngModel)]="item.attributeName" [readonly]="item.isLocked" autocomplete="off" />
      </mat-form-field>

      <mat-form-field class="w-100">
        <mat-label>Search value</mat-label>
        <input type="text" matInput [(ngModel)]="item.textValue" autocomplete="off" />
      </mat-form-field>

      <button mat-raised-button color="primary" class="w-100" (click)="applyChanges()">Apply</button>
    </div>

    <div *ngSwitchCase="FilterBarType.NUMERIC">
      <mat-form-field *ngIf="!item.isLocked" class="w-100">
        <mat-label>Attribute name</mat-label>
        <input type="text" matInput [(ngModel)]="item.attributeName" [readonly]="item.isLocked" autocomplete="off" />
      </mat-form-field>

      <mat-form-field class="w-100">
        <mat-label>Min</mat-label>
        <input type="number" matInput [(ngModel)]="item.min" />
      </mat-form-field>

      <mat-form-field class="w-100">
        <mat-label>Max</mat-label>
        <input type="number" matInput [(ngModel)]="item.max" />
      </mat-form-field>

      <button mat-raised-button color="primary" class="w-100" (click)="applyChanges()">Apply</button>
    </div>

    <div *ngSwitchCase="FilterBarType.DATE">
      <mat-form-field *ngIf="!item.isLocked" class="w-100">
        <mat-label>Attribute name</mat-label>
        <input type="text" matInput [(ngModel)]="item.attributeName" [readonly]="item.isLocked" autocomplete="off" />
      </mat-form-field>

      <div class="date-filters">
        <step-date-filter label="From" (dateChanged)="onMinDateChanged($event)"></step-date-filter>
        <step-date-filter label="To" (dateChanged)="onMaxDateChanged($event)"></step-date-filter>
      </div>

      <button mat-raised-button color="primary" class="w-100" (click)="applyChanges()">Apply</button>
    </div>
  </div>
</mat-menu>
