<step-drag-drop-container>
  <step-table
    data-step-testid="automation-packages-resources-table"
    #table
    [dataSource]="dataSource"
    matSort
    [matSortDisableClear]="true"
    [filter]="AP_RESOURCE_FILTER"
  >
    <step-bulk-operations *stepAdditionalHeader="'btngroup-bulk-import-create'" entity="automationPackageResources" />
    <section class="header" *stepAdditionalHeader="'btngroup-bulk-import-create'">
      <step-btn-group>
        <a
          data-step-testid="new-resource-btn"
          mat-mini-fab
          color="primary"
          matTooltip="New automation package library"
          matTooltipPosition="below"
          [disabled]="!('resource-write' | hasRight | async)"
          [routerLink]="['.', 'upload']"
          [relativeTo]="_activatedRoute"
        >
          <step-icon name="plus"></step-icon>
        </a>
      </step-btn-group>
    </section>
    <ng-container matColumnDef="bulkSelection">
      <th mat-header-cell *matHeaderCellDef class="bulk-selection-cell"></th>
      <td mat-cell *matCellDef="let element">
        <step-entity-selection [entity]="element" />
      </td>
    </ng-container>
    <step-entity-column-container entityName="resources"></step-entity-column-container>
    <ng-container matColumnDef="name" stepActivityCol="Name" stepSearchCol>
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <step-drag-column-caption>Name</step-drag-column-caption>
      </th>
      <td mat-cell *matCellDef="let element">
        <a class="resource-link" [routerLink]="element | resourceUrl">
          {{ element.attributes.name }}
        </a>
      </td>
    </ng-container>
    <ng-container matColumnDef="resourceType" stepActivityCol="Type" stepSearchCol>
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <step-drag-column-caption>Type</step-drag-column-caption>
      </th>
      <td mat-cell *matCellDef="let element">{{ element.resourceType }}</td>
    </ng-container>
    <ng-container matColumnDef="id" stepActivityCol="Id" stepSearchCol>
      <step-input-filter
        data-step-testid="id-input"
        *stepSearchCellDef
        stepFilterConnect
        [useRegex]="false"
      ></step-input-filter>
      <th mat-header-cell *matHeaderCellDef mat-sort-header>
        <step-drag-column-caption>Id</step-drag-column-caption>
      </th>
      <td mat-cell *matCellDef="let element">{{ element.id }}</td>
    </ng-container>
    <ng-container matColumnDef="automationPackage" stepActivityCol="Automation package" stepSearchCol>
      <step-automation-package-filter *stepSearchCellDef stepFilterConnect />
      <th class="automation-package-cell" mat-header-cell *matHeaderCellDef>
        <step-drag-column-caption>&nbsp;</step-drag-column-caption>
      </th>
      <td mat-cell *matCellDef="let element">
        <step-automation-package-ref-icon [entity]="element" />
      </td>
    </ng-container>
    <ng-container matColumnDef="actions" stepActionCol>
      <th mat-header-cell *matHeaderCellDef>
        Actions
        <step-column-settings />
      </th>
      <td mat-cell *matCellDef="let element" class="cell-actions">
        <step-btn-group [stepEntityRef]="element">
          <button
            data-step-testid="download-resource-btn"
            mat-icon-button
            matTooltip="Download resource"
            (click)="downloadResource(element.id)"
          >
            <step-icon name="download-cloud" />
          </button>
          <button
            data-step-testid="refresh-resource-btn"
            mat-icon-button
            matTooltip="Refresh resource"
            [disabled]="!('resource-write' | hasRight | async)"
            (click)="refreshResource(element)"
          >
            <step-icon name="refresh-cw" />
          </button>
          <button
            data-step-testid="delete-resource-btn"
            mat-icon-button
            matTooltip="Delete resource"
            [disabled]="!('resource-delete' | hasRight | async)"
            (click)="deleteResource(element.id, element.resourceName)"
          >
            <step-icon name="trash-2">delete</step-icon>
          </button>
        </step-btn-group>
      </td>
    </ng-container>
  </step-table>
</step-drag-drop-container>
<router-outlet />
