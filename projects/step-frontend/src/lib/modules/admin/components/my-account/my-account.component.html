<h3>My account</h3>
<mat-card>
  <mat-card-header>
    <mat-card-title>Credentials</mat-card-title>
  </mat-card-header>
  <mat-card-content class="credentials">
    <section>
      <step-label>
        <strong>Username </strong>
        <span>{{ user.username }}</span>
      </step-label>
      <button type="button" mat-flat-button color="primary" (click)="changePwd()" [disabled]="!canChangePassword">
        Change password
      </button>
    </section>
    <section>
      <step-label>
        <strong>Api key</strong>
      </step-label>
      <button
        type="button"
        mat-flat-button
        color="primary"
        (click)="invokeShowGenerateApiKeyDialog()"
        [disabled]="!canGenerateApiKey"
      >
        Generate new Key
      </button>
    </section>
    <table class="account-table api-token-table" [class.disabled]="!canGenerateApiKey">
      <thead>
        <tr>
          <th>Label</th>
          <th>Created</th>
          <th>Valid until</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let token of tokens; trackBy: trackByToken">
          <td [matTooltip]="token.token">
            {{ token.label || token.id }}
          </td>
          <td>
            {{ token.creationTime | date }}
          </td>
          <td>
            {{ token.expiryTime | date }}
          </td>
          <td><a (click)="revokeAPIToken(token.id)">revoke</a></td>
        </tr>
      </tbody>
    </table>
  </mat-card-content>
</mat-card>
<mat-card>
  <mat-card-header>
    <mat-card-title>Role</mat-card-title>
  </mat-card-header>
  <mat-card-content class="role">
    <section>
      <step-label>
        <strong>Role </strong>
        <span>{{ user.role }}</span>
      </step-label>
    </section>
  </mat-card-content>
</mat-card>
<mat-card>
  <mat-card-header class="preferences-title">
    <mat-card-title> Preferences </mat-card-title>
    <button type="button" mat-icon-button mat-flat-button color="primary" (click)="addPreference()">
      <step-icon name="plus"></step-icon>
    </button>
  </mat-card-header>
  <mat-card-content>
    <table class="account-table">
      <thead>
        <tr>
          <th>Key</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let pref of preferences">
          <td>
            <step-form-field>
              <input [(ngModel)]="pref.key" placeholder="Key" (blur)="savePreferences()" />
            </step-form-field>
          </td>
          <td>
            <step-form-field>
              <input [(ngModel)]="pref.value" placeholder="Value" (blur)="savePreferences()" />
            </step-form-field>
          </td>
        </tr>
      </tbody>
    </table>
  </mat-card-content>
</mat-card>
